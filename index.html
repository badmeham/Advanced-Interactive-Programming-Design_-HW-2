
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Particle System</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0; /* Remove default margin */
  overflow: hidden; /* Prevent scrolling */
}

/* Style for the sliding menu */
.menu {
  position: fixed;
  top: 0;
  left: -250px;
  width: 250px;
  height: 100%;
  background-color: #111;
  transition: left 0.3s ease;
  overflow-x: hidden;
  padding-top: 100px;
}

.menu a {
  display: block;
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 25px;
  color: #818181;
  transition: 0.3s;
}

.menu a:hover {
  color: #f1f1f1;
}

#openMenu {
  font-size: 30px;
  cursor: pointer;
  position: fixed;
  top: 22px;
  left: 15px;
  z-index: 1000;
  color: #818181;
  background-color: #111;
  border-radius: 5px;
  padding: 10px;
  width: 35px;
  height: 35px;
  text-align: center;
  position: absolute; /* Добавлено позиционирование */
  
}

.closebtn {
  position: absolute;
  top: 30px;
  right: 25px;
  font-size: 60px;
  margin-left: 50px;
  color: #818181;
  transition: 0.3s;
  
}

.closebtn:hover {
  color: #818181;
}
</style>


</head>
<body>
  <!-- Sliding menu -->
  <div class="menu" id="sideMenu">
    <a href="javascript:void(0)" onclick="showText()">Show Text</a>
    <a href="#" onclick="refresh()">Refresh</a>
    <a href="javascript:void(0)" onclick="playMusic()">Play Music</a>
    <a href="javascript:void(0)" class="closebtn" onclick="closeMenu()">X</a>
  </div>

  <audio id="backgroundMusic" loop>
    <source src="EdSheeran_ShapeOfYou.mp3" type="audio/mpeg">   
  </audio>

  <!-- Hamburger toggle button to open the menu -->
  <div id="openMenu" onclick="openMenu()">☰</div>







  <!-- p5.js canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <script>
    let particles = [];
    let flowField;
    let cols, rows;
    let inc = 0.1;
    let scl = 20;
    let zoff = 0;
    let fr;
    let isPlaying = false;

    let opacity = 0; // Начальная прозрачность текста
    let showTextFlag = false; // Флаг для отображения текста
    let isRedYellow = false; // Флаг для определения текущего цвета
    
  

    function playMusic() {
  var audio = document.getElementById("backgroundMusic");
  if (audio.paused) {
    audio.play();
    isPlaying = true;
  } else {
    audio.pause();
    isPlaying = false;
  }
}


    function setup() {
      createCanvas(windowWidth, windowHeight);
      cols = floor(width / scl);
      rows = floor(height / scl);
      flowField = new Array(cols * rows);

      for (let i = 0; i < 1000; i++) {
        particles[i] = new Particle();
      }
      background(0);
    }



    class Particle {
      constructor() {
        this.pos = createVector(random(width), random(height));
        this.vel = createVector(0, 0);
        this.acc = createVector(0, 0);
        this.maxSpeed = 2;
        this.prevPos = this.pos.copy();
        this.color = color(random(0, 100), random(100, 200), random(200, 255), random(20, 100));
      }

      show() {
        stroke(this.color);
        strokeWeight(0.5);
        line(this.pos.x, this.pos.y, this.prevPos.x, this.prevPos.y);
        this.updatePrev();
      }

      update() {
        this.vel.add(this.acc);
        this.vel.limit(this.maxSpeed);
        this.pos.add(this.vel);
        this.acc.mult(0);
      }

      follow(vectors) {
        let x = floor(this.pos.x / scl);
        let y = floor(this.pos.y / scl);
        let index = x + y * cols;
        let force = vectors[index];
        this.applyForce(force);
      }

      applyForce(force) {
        this.acc.add(force);
      }

      updatePrev() {
        this.prevPos.x = this.pos.x;
        this.prevPos.y = this.pos.y;
      }
      
      edges() {
  if (this.pos.x > width) {
    this.pos.x = 0;
    this.updatePrev();
  }
  if (this.pos.x < 0) {
    this.pos.x = width;
    this.updatePrev();
  }
  if (this.pos.y > height) {
    this.pos.y = 0;
    this.updatePrev();
  }
  if (this.pos.y < 0) {
    this.pos.y = height;
    this.updatePrev();
  }
}
}

// Event listener for opening the menu
function openMenu() {
document.getElementById('sideMenu').style.left = '0';
}

// Event listener for closing the menu
function closeMenu() {
document.getElementById('sideMenu').style.left = '-250px';
}

// // Event listener for "Show Text" menu item
// function showText() {
// alert('This is a message from p5.js!');
// }

// Event listener for "Refresh" menu item
function refresh() {
setup();
}

// Функция для смены цвета на красный с желтым
function changeColor() {
  if (isRedYellow) {
    // Если текущий цвет - красный с желтым, меняем на голубой с синим
    for (let i = 0; i < particles.length; i++) {
      particles[i].color = color(random(0, 100), random(100, 200), random(200, 255), random(20, 100));
    }
    isRedYellow = false; // Устанавливаем флаг
  } else {
    // Если текущий цвет - голубой с синим, меняем на красный с желтым
    for (let i = 0; i < particles.length; i++) {
      particles[i].color = color(random(255, 255), random(100, 200), random(0, 100), random(20, 100));
    }
    isRedYellow = true; // Устанавливаем флаг
  }
}

// Функция для обновления частиц и потокового поля после смены цвета
function refresh() {
  setup(); // Пересоздаем частицы и потоковое поле
  changeColor(); // Меняем цвет
}

    function draw() {
        // Draw the flow field and particles
        let yoff = 0;
        for (let y = 0; y < rows; y++) {
            let xoff = 0;
            for (let x = 0; x < cols; x++) {
                let index = x + y * cols;
                let angle = noise(xoff, yoff, zoff) * TWO_PI * 2;
                angle += random(-PI / 2, PI / 2);
                let v = p5.Vector.fromAngle(angle);
                v.setMag(0.2); // Уменьшение величины вектора для замедления частиц
                flowField[index] = v;
                xoff += inc;
            }
            yoff += inc;
            zoff += 0.0003;
        }

        for (let i = 0; i < particles.length; i++) {
            particles[i].follow(flowField);
            particles[i].update();
            particles[i].edges();
            particles[i].show();
        }


        //ТЕКСТ
        
        if (showTextFlag) {
    fadeOutText(); // Вызываем функцию для отображения и затухания текста
  }

        }




        // ТЕКСТ

        // Функция для отображения текста с эффектом затухания
function fadeOutText() {
  fill(0, opacity); // Задаем цвет с прозрачностью
  textSize(32); // Размер текста
  textAlign(CENTER, CENTER); // Выравнивание текста по центру
  text('Made by Dari Abidueva', width / 2, height / 2); // Рисуем текст

  // Увеличиваем прозрачность до максимального значения
  if (opacity < 255) {
    opacity += 5; // Увеличиваем прозрачность каждый кадр
  }
}

// Функция для отображения текста после задержки
function showTextWithDelay() {
  showTextFlag = true; // Устанавливаем флаг отображения текста

  // Задержка перед затуханием текста
  setTimeout(() => {
    showTextFlag = false; // Сбрасываем флаг отображения текста
    opacity = 0; // Сбрасываем прозрачность до начального значения
  }, 2000); // Задержка в 2 секунды
}

// Event listener for "Show Text" menu item
function showText() {
  showTextWithDelay(); // Изменено на вызов функции для плавного отображения текста
}







</script>
</body>
</html>